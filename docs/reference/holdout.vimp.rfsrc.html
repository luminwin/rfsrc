<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Hold out variable importance (VIMP) — holdout.vimp.rfsrc • Fast Unified Random Forests with randomForestSRC</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Hold out variable importance (VIMP) — holdout.vimp.rfsrc"><meta property="og:description" content="Hold out VIMP is calculated from the error rate of mini ensembles of
  trees (blocks of trees) grown with and without a variable.  Applies to
  all families."><meta property="og:image" content="https://www.randomforestsrc.org/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-WZWXVK817Z"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WZWXVK817Z');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Fast Unified Random Forests with randomForestSRC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/getstarted.html">
    <span class="fas fa-home fa-lg"></span>

    Getting Started
  </a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li>
  <a href="../cheatsheets.pdf">Cheatsheet</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/parallel.html">Parallel Processing</a>
    </li>
    <li>
      <a href="../articles/hybrid.html">Hybrid Parallel Processing</a>
    </li>
    <li>
      <a href="../articles/algorithm.html">randomForestSRC Algorithm</a>
    </li>
    <li>
      <a href="../articles/speedup.html">Speedup Random Forest Analyses</a>
    </li>
    <li>
      <a href="../articles/forestWgt.html">Forest Weights, In-Bag (IB) and Out-of-Bag (OOB) Ensembles</a>
    </li>
    <li>
      <a href="../articles/survival.html">Random Survival Forests</a>
    </li>
    <li>
      <a href="../articles/competing.html">Competing Risks</a>
    </li>
    <li>
      <a href="../articles/imbalance.html">Random Forests Quantile Classifier (RFQ)</a>
    </li>
    <li>
      <a href="../articles/mvsplit.html">Multivariate Splitting Rule</a>
    </li>
    <li>
      <a href="../articles/aucsplit.html">AUC Splitting Rule for Multiclass Problems</a>
    </li>
    <li>
      <a href="../articles/sidClustering.html">sidClustering</a>
    </li>
    <li>
      <a href="../articles/rfsrc-subsample.html">Variable Importance (VIMP) with Subsampling Inference</a>
    </li>
    <li>
      <a href="../articles/minidep.html">Minimal Depth</a>
    </li>
    <li>
      <a href="../articles/partial.html">Partial Plots</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
<li>
  <a href="https://github.com/kogalur/randomForestSRC/issues" class="external-link">Bug Reporting</a>
</li>
<li>
  <a href="https://github.com/kogalur/randomForestSRC/discussions" class="external-link">Discussions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://kogalur.github.io/randomForestSRC/javadoc" class="external-link">Java API</a>
</li>
<li>
  <a href="https://github.com/kogalur/randomForestSRC/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

    GitHub
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kogalur/randomForestSRC/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

    GitHub
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Hold out variable importance (VIMP)</h1>

    <div class="hidden name"><code>holdout.vimp.rfsrc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Hold out VIMP is calculated from the error rate of mini ensembles of
  trees (blocks of trees) grown with and without a variable.  Applies to
  all families.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">holdout.vimp</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>,</span>
<span>  ntree <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">vtry</span><span class="op">)</span><span class="op">{</span><span class="fl">1000</span> <span class="op">*</span> <span class="va">p</span> <span class="op">/</span> <span class="va">vtry</span><span class="op">}</span>,</span>
<span>  nsplit <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  ntime <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  sampsize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span> <span class="op">*</span> <span class="fl">.632</span><span class="op">}</span>,</span>
<span>  samptype <span class="op">=</span> <span class="st">"swor"</span>,</span>
<span>  block.size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  vtry <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A symbolic description of the model to be fit.</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data frame containing the y-outcome and x-variables.</p></dd>

  <dt id="arg-ntree">ntree<a class="anchor" aria-label="anchor" href="#arg-ntree"></a></dt>
<dd><p>Function specifying requested number of trees used for
    growing the forest.  Inputs are dimension and number of holdout
    variables. The requested number of trees can also be a number.</p></dd>

  <dt id="arg-nsplit">nsplit<a class="anchor" aria-label="anchor" href="#arg-nsplit"></a></dt>
<dd><p>Non-negative integer value specifying number of
    random split points used to split a node (deterministic splitting
    corresponds to the value zero and is much slower).</p></dd>

  <dt id="arg-ntime">ntime<a class="anchor" aria-label="anchor" href="#arg-ntime"></a></dt>
<dd><p>Integer value used for survival to
    constrain ensemble calculations to a grid of <code>ntime</code> time points.</p></dd>

  <dt id="arg-sampsize">sampsize<a class="anchor" aria-label="anchor" href="#arg-sampsize"></a></dt>
<dd><p>Function specifying size of subsampled data. Can also
    be a number.</p></dd>

  <dt id="arg-samptype">samptype<a class="anchor" aria-label="anchor" href="#arg-samptype"></a></dt>
<dd><p>Type of bootstrap used.</p></dd>

  <dt id="arg-vtry">vtry<a class="anchor" aria-label="anchor" href="#arg-vtry"></a></dt>
<dd><p>Number of variables randomly selected to be held out when
    growing a tree.  This can also be set to a list for a targeted hold
    out VIMP analysis.  See details below for more information.</p></dd>

  <dt id="arg-block-size">block.size<a class="anchor" aria-label="anchor" href="#arg-block-size"></a></dt>
<dd><p>Specifies number of trees in a block when calculating
    holdout variable importance.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments to be passed to <code><a href="rfsrc.html">rfsrc</a></code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>


<p>Holdout variable importance (holdout VIMP) is based on comparing error
  performance of two mini forests of trees (blocks of trees): the first in
  which a random set of <code>vtry</code> features are held out (the holdout
  forest), and the second in which no features are held out (the
  baseline forest).</p>
<p>To summarize, holdout VIMP measures the importance of a variable when
  that variable is truly removed from the tree growing process.</p>
<p>Specifically, if a feature is held out in a block of trees, we refer
  to this as the (feature, block) pair.  The bootstrap for the trees in
  a (feature, block) pair are identical in both forests. That is, the
  holdout block is grown by holding out the feature, and the baseline
  block is grown over the same trees, with the same bootstrap, but
  without holding out any features.  <code>vtry</code> controls how many
  features are held out in every tree. If set to one (default), only one
  variable is held out in every tree.  Once a (feature, block) of trees
  has been grown, holdout VIMP for a given variable v is calculated as
  follows.  Gather the block of trees where the feature was held out
  (from the holdout forest) and calculate OOB prediction error.  Next
  gather the corresponding block of trees where v was not held out (from
  the baseline forest) and calculate OOB prediction error.  Holdout VIMP
  for the (feature, block) pair is the difference between these two
  values.  The final holdout VIMP estimate for a feature v is obtained
  by averaging holdout VIMP for (feature=v, block) over all blocks.</p>
<p>Accuracy of hold out VIMP depends critically on total number of trees.
  If total number of trees is too small, then number of times a variable
  is held out will be small and OOB error can suffer from high variance.
  Therefore, <code>ntree</code> should be set fairly high—we recommend using
  1000 times the number of features.  Increasing <code>vtry</code> is another
  way to increase number of times a variable is held out and therefore
  reduces the burden of growing a large number of trees.  In particular,
  total number of trees needed decreases linearly with <code>vtry</code>.  The
  default <code>ntree</code> equals 1000 trees for each feature divided by
  <code>vtry</code>.  Keep in mind intrepretation of holdout VIMP is altered
  when <code>vtry</code> is different than one.  Thus this option should be
  used with caution.</p>
<p>Accuracy also depends on the value of <code>block.size</code>.  Smaller
  values generally produce better results but are more computationally
  demanding.  The most computationally demanding, but most accurate, is
  <code>block.size=1</code>.  This is similar to how <code>block.size</code> is used
  for usual variable importance: see the help file for <code class="command">rfsrc</code>
  for details.  Note the value of <code>block.size</code> should not exceed
  <code>ntree</code> divided by number of features, otherwise there may not be
  enough trees to satisify the target block size for a feature and
  missing values will result.</p>
<p>A targeted hold out VIMP analysis can be requested by setting
  <code>vtry</code> to a list with two entries.  The first entry is a vector
  of integer values specifying the variables of interest.  The second
  entry is a boolean logical flag indicating whether individual or joint
  VIMP should be calculated.  For example, suppose variables 1, 4 and 5
  are our variables of interest.  To calculate holdout VIMP for these
  variables, and these variables only, <code>vtry</code> would be specified by</p>
<p>vtry = list(xvar = c(1, 4, 5), joint = FALSE)</p>
<p>On the other hand, if we are interested in the joint effect when we
   remove the three variables simultaneously, then</p>
<p>vtry = list(xvar = c(1, 4, 5), joint = TRUE)</p>
<p>The benefits of a targeted analysis is that the user may have a
   pre-conceived idea of which variables are interesting.  Only VIMP for
   these variables will be calculated which greatly reduces
   computational time.  Another benefit is that when joint VIMP is
   requested, this provides the user with a way to assess importance of
   specific groups of variables.  See the iris example below for
   illustration.</p>


    </div>
    <div id="value">
    <h2>Value</h2>
    <p>Invisibly a list with the following components (which themselves can be lists):</p>
<dl><dt>importance</dt>
<dd><p>Holdout VIMP.</p></dd>

  <dt>baseline</dt>
<dd><p>Prediction error for the baseline forest.</p></dd>

  <dt>holdout</dt>
<dd><p>Prediction error for the holdout forest.</p></dd>

</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Hemant Ishwaran and Udaya B. Kogalur</p>
    </div>
    <div id="references">
    <h2>References</h2>


<p>Lu M. and Ishwaran H. (2018). Expert Opinion: A prediction-based
  alternative to p-values in regression models. <em>J. Thoracic and
    Cardiovascular Surgery</em>, 155(3), 1130–1136.</p>


    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code class="command"><a href="vimp.rfsrc.html">vimp.rfsrc</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># \donttest{</span></span>
<span></span>
<span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span><span class="co">## regression analysis</span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## new York air quality measurements</span></span>
<span><span class="va">airq.obj</span> <span class="op">&lt;-</span> <span class="fu">holdout.vimp</span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">airquality</span>, na.action <span class="op">=</span> <span class="st">"na.impute"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">airq.obj</span><span class="op">$</span><span class="va">importance</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span><span class="co">## classification analysis</span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## iris data</span></span>
<span><span class="va">iris.obj</span> <span class="op">&lt;-</span> <span class="fu">holdout.vimp</span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">iris.obj</span><span class="op">$</span><span class="va">importance</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## iris data using brier prediction error</span></span>
<span><span class="va">iris.obj</span> <span class="op">&lt;-</span> <span class="fu">holdout.vimp</span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, perf.type <span class="op">=</span> <span class="st">"brier"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">iris.obj</span><span class="op">$</span><span class="va">importance</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span><span class="co">## illustration of targeted holdout vimp analysis</span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## iris data - only interested in variables 3 and 4</span></span>
<span><span class="va">vtry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, joint <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">holdout.vimp</span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, vtry <span class="op">=</span> <span class="va">vtry</span><span class="op">)</span><span class="op">$</span><span class="va">impor</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## iris data - joint importance of variables 3 and 4</span></span>
<span><span class="va">vtry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, joint <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">holdout.vimp</span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, vtry <span class="op">=</span> <span class="va">vtry</span><span class="op">)</span><span class="op">$</span><span class="va">impor</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## iris data - joint importance of variables 1 and 2</span></span>
<span><span class="va">vtry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, joint <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">holdout.vimp</span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, vtry <span class="op">=</span> <span class="va">vtry</span><span class="op">)</span><span class="op">$</span><span class="va">impor</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span><span class="co">## imbalanced classification (using RFQ)</span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/topepo/caret/" class="external-link">"caret"</a></span>, logical.return <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co">## experimental settings</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">400</span></span>
<span>  <span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span>  <span class="va">ir</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span>  <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span>
<span> </span>
<span>  <span class="co">## simulate the data, create minority class data</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/twoClassSim.html" class="external-link">twoClassSim</a></span><span class="op">(</span><span class="va">n</span>, linearVars <span class="op">=</span> <span class="fl">15</span>, noiseVars <span class="op">=</span> <span class="va">q</span><span class="op">)</span></span>
<span>  <span class="va">d</span><span class="op">$</span><span class="va">Class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">Class</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">idx.0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">Class</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">idx.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">Class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">Class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="va">ir</span> , replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">idx.0</span>,<span class="va">idx.1</span><span class="op">)</span>,, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co">## VIMP for RFQ with and without blocking</span></span>
<span>  <span class="va">vmp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="imbalanced.rfsrc.html">imbalanced</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">d</span>, importance <span class="op">=</span> <span class="cn">TRUE</span>, block.size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">importance</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">vmp10</span> <span class="op">&lt;-</span> <span class="fu"><a href="imbalanced.rfsrc.html">imbalanced</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">d</span>, importance <span class="op">=</span> <span class="cn">TRUE</span>, block.size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">$</span><span class="va">importance</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co">## holdout VIMP for RFQ with and without blocking</span></span>
<span>  <span class="va">hvmp1</span> <span class="op">&lt;-</span> <span class="fu">holdout.vimp</span><span class="op">(</span><span class="va">f</span>, <span class="va">d</span>, rfq <span class="op">=</span>  <span class="cn">TRUE</span>,</span>
<span>               perf.type <span class="op">=</span> <span class="st">"g.mean"</span>, block.size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">importance</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">hvmp10</span> <span class="op">&lt;-</span> <span class="fu">holdout.vimp</span><span class="op">(</span><span class="va">f</span>, <span class="va">d</span>, rfq <span class="op">=</span>  <span class="cn">TRUE</span>,</span>
<span>               perf.type <span class="op">=</span> <span class="st">"g.mean"</span>, block.size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">$</span><span class="va">importance</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co">## compare VIMP values</span></span>
<span>  <span class="va">imp</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">vmp1</span>, <span class="va">vmp10</span>, <span class="va">hvmp1</span>, <span class="va">hvmp10</span><span class="op">)</span></span>
<span>  <span class="va">legn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vimp-1"</span>, <span class="st">"vimp-10"</span>,<span class="st">"hvimp-1"</span>, <span class="st">"hvimp-10"</span><span class="op">)</span></span>
<span>  <span class="va">colr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">20</span><span class="op">+</span><span class="va">q</span><span class="op">)</span></span>
<span>  <span class="va">colr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span>  <span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">imp</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">nms</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">20</span><span class="op">+</span><span class="va">q</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">imp</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,col<span class="op">=</span><span class="va">colr</span>,las<span class="op">=</span><span class="fl">2</span>,main<span class="op">=</span><span class="va">legn</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,ylim<span class="op">=</span><span class="va">ylim</span>,names.arg<span class="op">=</span><span class="va">nms</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">imp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,col<span class="op">=</span><span class="va">colr</span>,las<span class="op">=</span><span class="fl">2</span>,main<span class="op">=</span><span class="va">legn</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,ylim<span class="op">=</span><span class="va">ylim</span>,names.arg<span class="op">=</span><span class="va">nms</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">imp</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,col<span class="op">=</span><span class="va">colr</span>,las<span class="op">=</span><span class="fl">2</span>,main<span class="op">=</span><span class="va">legn</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,ylim<span class="op">=</span><span class="va">ylim</span>,names.arg<span class="op">=</span><span class="va">nms</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">imp</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span>,col<span class="op">=</span><span class="va">colr</span>,las<span class="op">=</span><span class="fl">2</span>,main<span class="op">=</span><span class="va">legn</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,ylim<span class="op">=</span><span class="va">ylim</span>,names.arg<span class="op">=</span><span class="va">nms</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span><span class="co">## multivariate regression analysis</span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span><span class="va">mtcars.mreg</span> <span class="op">&lt;-</span> <span class="fu">holdout.vimp</span><span class="op">(</span><span class="fu">Multivar</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">cyl</span><span class="op">)</span> <span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">mtcars</span>,</span>
<span>                                    vtry <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                    block.size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                    samptype <span class="op">=</span> <span class="st">"swr"</span>,</span>
<span>                                    sampsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mtcars.mreg</span><span class="op">$</span><span class="va">importance</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span><span class="co">## mixed outcomes analysis</span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span></span>
<span><span class="va">mtcars.new</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span><span class="va">mtcars.new</span><span class="op">$</span><span class="va">cyl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mtcars.new</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span></span>
<span><span class="va">mtcars.new</span><span class="op">$</span><span class="va">carb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mtcars.new</span><span class="op">$</span><span class="va">carb</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mtcars.mix</span> <span class="op">&lt;-</span> <span class="fu">holdout.vimp</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">carb</span>, <span class="va">mpg</span>, <span class="va">cyl</span><span class="op">)</span> <span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">mtcars.new</span>,</span>
<span>                                   ntree <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                   block.size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                   vtry <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mtcars.mix</span><span class="op">$</span><span class="va">importance</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##------------------------------------------------------------</span></span>
<span><span class="co">## survival analysis</span></span>
<span><span class="co">##------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## Primary biliary cirrhosis (PBC) of the liver</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pbc</span>, package <span class="op">=</span> <span class="st">"randomForestSRC"</span><span class="op">)</span></span>
<span><span class="va">pbc.obj</span> <span class="op">&lt;-</span> <span class="fu">holdout.vimp</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">days</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">pbc</span>,</span>
<span>                                nsplit <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                                ntree <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                                na.action <span class="op">=</span> <span class="st">"na.impute"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pbc.obj</span><span class="op">$</span><span class="va">importance</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##------------------------------------------------------------</span></span>
<span><span class="co">## competing risks</span></span>
<span><span class="co">##------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## WIHS analysis</span></span>
<span><span class="co">## cumulative incidence function (CIF) for HAART and AIDS stratified by IDU</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wihs</span>, package <span class="op">=</span> <span class="st">"randomForestSRC"</span><span class="op">)</span></span>
<span><span class="va">wihs.obj</span> <span class="op">&lt;-</span> <span class="fu">holdout.vimp</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">wihs</span>,</span>
<span>                                 nsplit <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                 ntree <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">wihs.obj</span><span class="op">$</span><span class="va">importance</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># }</span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://www.luminwin.net" class="external-link">Min Lu</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

