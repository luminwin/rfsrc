<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Anonymous Random Forests — rfsrc.anonymous • Fast Unified Random Forests with randomForestSRC</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Anonymous Random Forests — rfsrc.anonymous" />
<meta property="og:description" content="

Anonymous random forests applies random forests but is carefully
  modified so as not to save the original training data.  This allows
  users to share their forest with other researchers but without having
  to share their original data." />
<meta property="og:image" content="https://www.randomforestsrc.org/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WZWXVK817Z"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WZWXVK817Z');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Fast Unified Random Forests with randomForestSRC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Development version">3.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/getstarted.html">
    <span class="fas fa-home fa-lg"></span>
     
    Getting Started
  </a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li>
  <a href="../cheatsheets.pdf">Cheatsheet</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/parallel.html">Parallel Processing</a>
    </li>
    <li>
      <a href="../articles/hybrid.html">Hybrid Parallel Processing</a>
    </li>
    <li>
      <a href="../articles/algorithm.html">randomForestSRC Algorithm</a>
    </li>
    <li>
      <a href="../articles/speedup.html">Speedup Random Forest Analyses</a>
    </li>
    <li>
      <a href="../articles/forestWgt.html">Forest Weights, In-Bag (IB) and Out-of-Bag (OOB) Ensembles</a>
    </li>
    <li>
      <a href="../articles/survival.html">Random Survival Forests</a>
    </li>
    <li>
      <a href="../articles/competing.html">Competing Risks</a>
    </li>
    <li>
      <a href="../articles/imbalance.html">Random Forests Quantile Classifier (RFQ)</a>
    </li>
    <li>
      <a href="../articles/mvsplit.html">Multivariate Splitting Rule</a>
    </li>
    <li>
      <a href="../articles/sidClustering.html">sidClustering</a>
    </li>
    <li>
      <a href="../articles/rfsrc-subsample.html">Variable Importance (VIMP) with Subsampling Inference</a>
    </li>
    <li>
      <a href="../articles/minidep.html">Minimal Depth</a>
    </li>
    <li>
      <a href="../articles/partial.html">Partial Plots</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
<li>
  <a href="https://github.com/kogalur/randomForestSRC/issues">Bug Reporting</a>
</li>
<li>
  <a href="https://github.com/kogalur/randomForestSRC/discussions">Discussions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://kogalur.github.io/randomForestSRC/javadoc">Java API</a>
</li>
<li>
  <a href="https://github.com/kogalur/randomForestSRC/">
    <span class="fab fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Anonymous Random Forests</h1>
    
    <div class="hidden name"><code>rfsrc.anonymous.Rd</code></div>
    </div>

    <div class="ref-description">
    

<p>Anonymous random forests applies random forests but is carefully
  modified so as not to save the original training data.  This allows
  users to share their forest with other researchers but without having
  to share their original data.</p>
    </div>

    <pre class="usage"><span class='fu'>rfsrc.anonymous</span><span class='op'>(</span><span class='va'>formula</span>, <span class='va'>data</span>, forest <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A symbolic description of the model to be fit. If
    missing, unsupervised splitting is implemented.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Data frame containing the y-outcome and x-variables.</p></td>
    </tr>
    <tr>
      <th>forest</th>
      <td><p>Should the forest object be returned?  Used for
    prediction on new data and required by many of the package
    functions.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments as in <code><a href='rfsrc.html'>rfsrc</a></code>.  See the
   <code>rfsrc</code> help file for details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p>Calls <code><a href='rfsrc.html'>rfsrc</a></code> and returns an object with the training data
  removed so that users can share their forest while maintaining privacy
  of their data.</p>
<p>In order to predict on test data, it is however necessary for certain
  minimal information to be saved from the training data.  This includes
  the names of the original variables, and if factor variables are
  present, the levels of the factors.  The mean value and maximal class
  value for real and factor variables in the training data are also
  stored for the purposes of imputation on test data (see below).  The
  topology of grow trees is also saved, which includes among other
  things, the split values used for splitting tree nodes.</p>
<p>For the most privacy, we recommend that variable names be made
  non-identifiable and that data be coerced to real values.  If factors
  are required, the user should consider using non-identifiable factor
  levels.  However, in all cases, it is the users responsibility to
  de-identify their data and to check that data privacy holds.  We
  provide NO GUARANTEES of this.</p>
<p>Missing data is especially delicate with anonymous forests.  Training
  data cannot be imputed and the option <code>na.action="na.impute"</code>
  simply reverts to <code>na.action="na.omit"</code>.  Therefore if you have
  training data with missing values consider using pre-imputing the data
  using <code class='command'>impute</code>.  It is however possible to impute on test
  data.  The option <code>na.action="na.impute"</code> in the prediction call
  triggers a rough and fast imputation method where the value of missing
  test data are replaced by the mean (or maximal class) value from the
  training data.  A second option <code>na.action="na.random"</code> uses a
  fast random imputation method.</p>  
<p>In general, it is important to keep in mind that while anonymous
  forests tries to play nice with other functions in the package, it
  only works with calls that do not specifically require training data.</p>  
    

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>(rfsrc, grow, anonymous)</code>.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Hemant Ishwaran and Udaya B. Kogalur</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code class='command'><a href='rfsrc.html'>rfsrc</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># \donttest{</span>

<span class='co'>## ------------------------------------------------------------</span>
<span class='co'>## regression</span>
<span class='co'>## ------------------------------------------------------------</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'>rfsrc.anonymous</span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='va'>.</span>, <span class='va'>mtcars</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## ------------------------------------------------------------</span>
<span class='co'>## plot anonymous regression tree (using get.tree)</span>
<span class='co'>## TBD CURRENTLY NOT IMPLEMENTED </span>
<span class='co'>## ------------------------------------------------------------</span>
<span class='co'>## plot(get.tree(rfsrc.anonymous(mpg ~ ., mtcars), 10))</span>

<span class='co'>## ------------------------------------------------------------</span>
<span class='co'>## classification</span>
<span class='co'>## ------------------------------------------------------------</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'>rfsrc.anonymous</span><span class='op'>(</span><span class='va'>Species</span> <span class='op'>~</span> <span class='va'>.</span>, <span class='va'>iris</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## ------------------------------------------------------------</span>
<span class='co'>## survival</span>
<span class='co'>## ------------------------------------------------------------</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>veteran</span>, package <span class='op'>=</span> <span class='st'>"randomForestSRC"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'>rfsrc.anonymous</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>status</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>veteran</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## ------------------------------------------------------------</span>
<span class='co'>## competing risks</span>
<span class='co'>## ------------------------------------------------------------</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>wihs</span>, package <span class='op'>=</span> <span class='st'>"randomForestSRC"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'>rfsrc.anonymous</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>status</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>.</span>, <span class='va'>wihs</span>, ntree <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## ------------------------------------------------------------</span>
<span class='co'>## unsupervised forests</span>
<span class='co'>## ------------------------------------------------------------</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'>rfsrc.anonymous</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>iris</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## ------------------------------------------------------------</span>
<span class='co'>## multivariate regression</span>
<span class='co'>## ------------------------------------------------------------</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'>rfsrc.anonymous</span><span class='op'>(</span><span class='fu'>Multivar</span><span class='op'>(</span><span class='va'>mpg</span>, <span class='va'>cyl</span><span class='op'>)</span> <span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>mtcars</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## ------------------------------------------------------------</span>
<span class='co'>## prediction on test data with missing values using pbc data</span>
<span class='co'>## cases 1 to 312 have no missing values</span>
<span class='co'>## cases 313 to 418 having missing values</span>
<span class='co'>## ------------------------------------------------------------</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>pbc</span>, package <span class='op'>=</span> <span class='st'>"randomForestSRC"</span><span class='op'>)</span>
<span class='va'>pbc.obj</span> <span class='op'>&lt;-</span> <span class='fu'>rfsrc.anonymous</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>days</span>, <span class='va'>status</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>.</span>, <span class='va'>pbc</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>pbc.obj</span><span class='op'>)</span>

<span class='co'>## mean value imputation</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>pbc.obj</span>, <span class='va'>pbc</span><span class='op'>[</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>312</span><span class='op'>)</span>,<span class='op'>]</span>, na.action <span class='op'>=</span> <span class='st'>"na.impute"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## random imputation</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>pbc.obj</span>, <span class='va'>pbc</span><span class='op'>[</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>312</span><span class='op'>)</span>,<span class='op'>]</span>, na.action <span class='op'>=</span> <span class='st'>"na.random"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## ------------------------------------------------------------</span>
<span class='co'>## train/test setting but tricky because factor labels differ over</span>
<span class='co'>## training and test data</span>
<span class='co'>## ------------------------------------------------------------</span>

<span class='co'># first we convert all x-variables to factors</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>veteran</span>, package <span class='op'>=</span> <span class='st'>"randomForestSRC"</span><span class='op'>)</span>
<span class='va'>veteran.factor</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>veteran</span>, <span class='va'>factor</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>veteran.factor</span><span class='op'>$</span><span class='va'>time</span> <span class='op'>&lt;-</span> <span class='va'>veteran</span><span class='op'>$</span><span class='va'>time</span>
<span class='va'>veteran.factor</span><span class='op'>$</span><span class='va'>status</span> <span class='op'>&lt;-</span> <span class='va'>veteran</span><span class='op'>$</span><span class='va'>status</span>

<span class='co'># split the data into train/test data (25/75)</span>
<span class='co'># the train/test data have the same levels, but different labels</span>
<span class='va'>train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>veteran</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>veteran</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>veteran.factor</span><span class='op'>[</span><span class='va'>train</span>, <span class='op'>]</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>veteran.factor</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>, <span class='op'>]</span><span class='op'>)</span>

<span class='co'># grow the forest on the training data and predict on the test data</span>
<span class='va'>v.grow</span> <span class='op'>&lt;-</span> <span class='fu'>rfsrc.anonymous</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>status</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>.</span>, <span class='va'>veteran.factor</span><span class='op'>[</span><span class='va'>train</span>, <span class='op'>]</span><span class='op'>)</span> 
<span class='va'>v.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>v.grow</span>, <span class='va'>veteran.factor</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>, <span class='op'>]</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>v.grow</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>v.pred</span><span class='op'>)</span>



<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.luminwin.net'>Min Lu</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


